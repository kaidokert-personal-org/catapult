{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5f27fdf2_9b90fb8f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1476473
      },
      "writtenOn": "2022-01-18T21:54:32Z",
      "side": 1,
      "message": "Hi Folks, can I get a quick review on this? wpt-importer is blocked due to this.\n\nthanks!",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c2ffeee0_dbbcd1c7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003232
      },
      "writtenOn": "2022-01-18T21:58:03Z",
      "side": 1,
      "message": "I don\u0027t think we should expand the list of characters that we support natively unless we have no alternative. Can\u0027t we rewrite the test names during the import?",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1905d047_37e7b5fc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1476473
      },
      "writtenOn": "2022-01-18T22:36:24Z",
      "side": 1,
      "message": "Thank you Dirk! Do you mean rewrite test names in test expectations? (probably not). I have another CL escape test names in test expectations.\n\nIf you mean update the test files so that there is no such characters in test names, I would guess it will be difficult. Also we will be losing sync with upstream, which will probably cause all kinds of problems.\n\nIf we do want to make such a change, I think the change should be exported back to upstream. And I would expect owners of each test to make such a change.\n\nDo we have any rules of test names? we may need make this known to blink devs, and also get agreement at upstream.",
      "parentUuid": "c2ffeee0_dbbcd1c7",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a4175c11_52f9fdea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003232
      },
      "writtenOn": "2022-01-18T22:46:36Z",
      "side": 1,
      "message": "\u003e Thank you Dirk! Do you mean rewrite test names in test expectations? \n\u003e (probably not). I have another CL escape test names in test expectations.\n\nThat wasn\u0027t what I was initially suggesting, but that might be another option.\n\n\u003e If you mean update the test files so that there is no such characters \n\u003e in test names, I would guess it will be difficult. Also we will be \n\u003e losing sync with upstream, which will probably cause all kinds of problems.\n\nYes, that was what I was suggesting, and yes, there are downsides.\n\n\u003e If we do want to make such a change, I think the change should be exported \n\u003e back to upstream. And I would expect owners of each test to make such a change.\n\nIf we can get the WPT folks to not use \u0027[\u0027 or \u0027]\u0027, that would be even better. Given that those characters are often shell metacharacters, I think avoiding them is a good idea.\n\n\u003e \n\u003e Do we have any rules of test names? we may need make this known to blink devs,\n\u003e and also get agreement at upstream.\n\nWe have go/chrome-test-id (internal-only, and not actually that useful) and bit.ly/chromium-test-lists-format.\n\nNote that if there was an unescaped \u0027[\u0027 in the TestExpectations files, that would conflict with the way we use \u0027[\u0027 for tags and results.",
      "parentUuid": "1905d047_37e7b5fc",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e3ac6a82_97ae3a04",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1476473
      },
      "writtenOn": "2022-01-18T23:00:41Z",
      "side": 1,
      "message": "I tried to understand why we are getting those failures, as shown here:\nhttps://ci.chromium.org/ui/p/chromium/builders/try/linux-blink-rel/66448/overview\n\nThere are thousands of failures in webdriver tests, and we probably don\u0027t want to add them to the test expectations, even if the syntax allows that. So I will skip the recent changes in webdriver tests, and ask webdriver team to take a look.\n\nBut from the link above, we have tests that have brackets in test names. Just that they did not fail so did not cause any problem.",
      "parentUuid": "1905d047_37e7b5fc",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4f0c5981_9c36e48c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003232
      },
      "writtenOn": "2022-01-18T23:04:36Z",
      "side": 1,
      "message": "\u003e But from the link above, we have tests that have brackets in test names. \n\u003e Just that they did not fail so did not cause any problem.\n\nJust webdriver tests? Or also web platform tests? I didn\u0027t see any checked-in tests with those characters in the name, but maybe there are other tests that exist only in manifests?",
      "parentUuid": "e3ac6a82_97ae3a04",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "604f5d90_b2158087",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003232
      },
      "writtenOn": "2022-01-18T23:12:31Z",
      "side": 1,
      "message": "I think I misunderstood the patch initially, so I\u0027m slightly more comfortable\nwith this idea than I was before.\n\nHowever, I would still suggest that you fix this in the callers so that they either don\u0027t use \"[\" at all, or do the encoding themselves, so that by the time the name gets handed to typ it gets \"%5B\" and only has to then encode the \"%\" (producing %255B).\n\nThis seems clunky but the alternative has us adding more and more escape codes for more and more test types and more potential for confusion over what\u0027s legal where.\n\nI suppose it\u0027s possible that we could expand this in typ, but I would want to do this a bit more carefully to make sure we don\u0027t break other users when doing so.",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86c23c03_4880ad93",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1476473
      },
      "writtenOn": "2022-01-18T23:39:23Z",
      "side": 1,
      "message": "Looks like the tests that have bracket in their test names are all from webdriver test. And there are all old tests. I am not sure how webdriver test works, but looks like the stuffs inside the bracket are parameters to a test.\n\nDirk, maybe we can look at this from a different angle. If we ask what characters are not allowed in test name, (or reserved characters by the typ system), is it only \u0027[\u0027, \u0027]\u0027, and SPACE? So we won\u0027t need to escape any other characters?\n\nI have made a change in wpt-importer, so that it will change \u0027[\u0027 to %5B, etc. I had been asking myself, do I also need the change in typ? I guess we need, otherwise the test suite won\u0027t be able to match the test with its expectation?\n\nIf we only have \u0027[\u0027, \u0027]\u0027, SPACE and a few others I missed, maybe we can proceed to land this. I can update this CL to include those other characters that need an escape. And hopefully we don\u0027t have such issue any more.\n\nAs I am planning to skip changes in web driver side, this is not urgent any more.",
      "parentUuid": "604f5d90_b2158087",
      "revId": "bb09016ccbb6f6a3f7afa5199d29b0c6416daf24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}