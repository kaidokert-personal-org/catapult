{
  "comments": [
    {
      "key": {
        "uuid": "c4933f83_9cef2a7c",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Interesting how much this overlaps with Task.  Perhaps the logic to construct one of these from a Task should be a method on Task?  Or a staticmethod FromTask method in the TraversalTask type?\n\nAnother thought: it might be useful have more obviously distinct names for in-memory types vs. NDB types.  While reading through a function it\u0027d probably be helpful to be able to tell at a glance that one of Task and TraversalTask is NDB-backed, and the other is ephemeral.  (Or define the non-NDB types in a different module?)",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 32,
        "endChar": 78
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5def737_6ef0070f",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "The meaning of these constants are a little opaque :)\n\nThe colouring metaphor is fine, but add a brief comment here on the meaning of the colours.\n\n  # Traversal states.  As we traverse the vertices we \"colour\" them to mark our progress.\n  WHITE \u003d 0  # Never visited.\n  GREY \u003d 1   # Children added to traversal stack.\n  BLACK \u003d 2  # Done (implies all child vertices have been coloured BLACK too).\n\nOr perhaps name them like NOT_EVALUATED, CHILDREN_PENDING, and EVALUATION_DONE?",
      "range": {
        "startLine": 42,
        "startChar": 0,
        "endLine": 42,
        "endChar": 30
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bbfaad36_b7c0a967",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "This sentence is incomplete.",
      "range": {
        "startLine": 97,
        "startChar": 0,
        "endLine": 98,
        "endChar": 11
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f008e898_53ca7583",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "This is simpler:\n\n  new_tasks \u003d set(amendment_task_graph.keys())\n\nBut if you prefer to keep the correspondence with the current_task_keys expression then leave it as is.",
      "range": {
        "startLine": 146,
        "startChar": 0,
        "endLine": 146,
        "endChar": 63
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d058d1c_591f4a83",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 164,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Just `current_task` here, rather than repeating the dict lookup?  (And making it more obvious that the task being mutated is current_task.)",
      "range": {
        "startLine": 164,
        "startChar": 8,
        "endLine": 164,
        "endChar": 44
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ccd81de1_7a86d626",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 166,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Ditto: just `amendment_task` here?",
      "range": {
        "startLine": 166,
        "startChar": 8,
        "endLine": 166,
        "endChar": 46
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "48f06b7f_ba5bba03",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 192,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "This appears to be out of sync with the VALID_TRANSITIONS constant.",
      "range": {
        "startLine": 186,
        "startChar": 69,
        "endLine": 192,
        "endChar": 21
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bdc08262_e713383d",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 194,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "“This” and “us” are ambiguous here — is the audience here fellow implementers, or users of the interface?\n\nPerhaps s/This/This function/ (to distinguish from “this design” or “this implementation”) and s/us/callers/ ?",
      "range": {
        "startLine": 194,
        "startChar": 2,
        "endLine": 194,
        "endChar": 6
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33aae3d2_c3f25a94",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 240,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "The generator expression seems unnecessary here.  Just pass the iterable to `set`: \n\n  has_dependents |\u003d set(task.dependencies)\n\nOr to the `set.update` method:\n\n  has_dependends.update(task.dependencies)",
      "range": {
        "startLine": 240,
        "startChar": 22,
        "endLine": 240,
        "endChar": 59
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ccbde65d_c3b755d9",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 247,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "What\u0027s an event?  That\u0027s the first mention of this concept in this module.",
      "range": {
        "startLine": 247,
        "startChar": 18,
        "endLine": 247,
        "endChar": 23
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8a1e3fc_cf95cc07",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 247,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "What\u0027s the contract of `evaluator`?",
      "range": {
        "startLine": 247,
        "startChar": 25,
        "endLine": 247,
        "endChar": 34
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65863cec_0be2437f",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Perhaps `actions \u003d [lambda _: None]` instead of needing a special case for `first`?",
      "range": {
        "startLine": 253,
        "startChar": 0,
        "endLine": 253,
        "endChar": 14
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a4134f0_3d90026b",
        "filename": "dashboard/dashboard/pinpoint/models/task.py",
        "patchSetId": 1
      },
      "lineNbr": 309,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Shouldn\u0027t this branch pop the stack too?  It looks like this loop will never terminate.\n\nOh, but then BLACK tasks are always immediately popped from the stack, so this branch will never happen!  So this assert is misleading, and would make more sense as:\n\n   assert false, \"task_stack only holds WHITE and GREY vertices\"",
      "range": {
        "startLine": 309,
        "startChar": 0,
        "endLine": 309,
        "endChar": 30
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6595eb8c_8039713e",
        "filename": "dashboard/dashboard/pinpoint/models/task_test.py",
        "patchSetId": 1
      },
      "lineNbr": 123,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "Call this NoopEvaluator.  It took me a lot more careful reading of this 30 line function to find the “SimpleNoop” promised in the test name than is ideal :)",
      "range": {
        "startLine": 123,
        "startChar": 8,
        "endLine": 123,
        "endChar": 17
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "70e76e1a_2caf3471",
        "filename": "dashboard/dashboard/pinpoint/models/task_test.py",
        "patchSetId": 1
      },
      "lineNbr": 417,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "There is a _lot_ of logic embedded in this test.  It significantly erodes the confidence this test can provide about correct behaviour.\n\nOff the top of my head if this could be structured a bit more like gMock code where you can define an action for an expected call that might work better?  (Where “expected call” is something like “evaluator called once with task matching …” and the action is something like “add another task via the call\u0027s accumulator arg”.)",
      "range": {
        "startLine": 417,
        "startChar": 0,
        "endLine": 417,
        "endChar": 55
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d00b6a12_ee24cbff",
        "filename": "dashboard/dashboard/pinpoint/models/task_test.py",
        "patchSetId": 1
      },
      "lineNbr": 420,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "How are event payloads related to task payloads?\n\nHmm, the task module doesn\u0027t have any concept of event payloads or types, they are completely opaque.  So (at least in the current state of the code) event payloads and event types are purely test-only constructs, but ones with confusingly similar names to concepts in the code being tested.\n\nI get the feeling that a lot of this test code needs to migrate to being part of the system being tested.",
      "range": {
        "startLine": 420,
        "startChar": 0,
        "endLine": 420,
        "endChar": 49
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f540667a_c5ed13d1",
        "filename": "dashboard/dashboard/pinpoint/models/task_test.py",
        "patchSetId": 1
      },
      "lineNbr": 464,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2019-09-02T05:50:30Z",
      "side": 1,
      "message": "The line break is unnecessary.",
      "range": {
        "startLine": 463,
        "startChar": 1,
        "endLine": 464,
        "endChar": 48
      },
      "revId": "312a67e2cd555313b5a045edbf3f21d5689d63ec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}