{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "790ba3a4_680d3b71",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1115906
      },
      "writtenOn": "2020-11-13T00:32:41Z",
      "side": 1,
      "message": "A couple of thoughts from the Lacros perspective -- hopefully this answers the outstanding questions, which appear to be variations on similar themes.\n\n(1) Lacros is in development and is not expected to launch until mid 2022 [earliest]. I assume there are existing ChromeOS telemetry users -- those should continue to work [as if lacros did not exist]\n\n(2) In a post-lacros world, there are two chrome binaries, which we call \u0027ash\u0027 and \u0027lacros\u0027 for simplicity. \u0027ash\u0027 controls login, window manager, ARC++ glue, etc. \u0027lacros\u0027 is the web browser.\n\nI imagine that telemetry would need to communicate with \u0027ash\u0027 to perform login/logout\nAnd that telemetry would otherwise communicate with \u0027lacros\u0027 as a web browser, as on other OSes.\n\n(3) There are two ways to launch lacros on a ChromeOS device. One is by clicking the icon on the dock [or alternatively, invoking the underlying logic]. The other is to launch Lacros directly from a bash/ssh terminal. The latter requires special glue to hook up the crosapi mojo connection between ash and lacros. This glue is here: https://source.chromium.org/chromium/chromium/src/+/master:build/lacros/mojo_connection_lacros_launcher.py?q\u003dlacros%20launcher\u0026ss\u003dchromium\nIt\u0027s targeted at Linux, but the comments seem to imply that it may also be usable on Chrome-OS devices. The main requirement is that ash is launched with --lacros-mojo-socket-for-testing\u003d/tmp/lacros.sock, and that lacros is launched with this wrapper.\n\nI think the open questions are:\n\n(a) How does telemetry get the appropriate binary onto the chromeOS device. Maybe it doesn\u0027t and we need another wrapper script?\n(b) Depends on (a) -- how do we launch Lacros?, see the two options outlined in (3)",
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7112b34f_5079fa85",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1451876
      },
      "writtenOn": "2020-11-13T00:37:53Z",
      "side": 1,
      "message": "(a) is an open question. For my testing, I manually deploy_chrome\u0027d ash-chrome and lacros-chrome. I\u0027m guessing this is easily automatable.\n\nFor (b), this CL launches whatever was deploy_chrome\u0027d via mojo_connection_lacross_launcher.py.",
      "parentUuid": "790ba3a4_680d3b71",
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "406d8db6_40b40907",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1451876
      },
      "writtenOn": "2020-11-13T00:38:33Z",
      "side": 1,
      "message": "Also, existing use cases continue to work exactly the same as they did before.",
      "parentUuid": "7112b34f_5079fa85",
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f89ff7a1_1de4ccec",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-11-13T00:51:23Z",
      "side": 1,
      "message": "\u003e How does telemetry get the appropriate binary onto the chromeOS device. Maybe it doesn\u0027t and we need another wrapper script?\n\nCorrect - Telemetry does not handle browser deployment on CrOS. We depend on the CrOS test wrapper scripts to handle that before Telemetry ever gets run.\n\n\u003e Depends on (a) -- how do we launch Lacros?\nWe assume that device is already on and the \"launching\" of the browser is handled here https://source.chromium.org/chromium/chromium/src/+/master:third_party/catapult/telemetry/telemetry/internal/backends/chrome/cros_browser_backend.py;l\u003d82 - AFAICT it\u0027s largely just logging in.\n\n\u003e  In a post-lacros world, there are two chrome binaries, which we call \u0027ash\u0027 and \u0027lacros\u0027 for simplicity. \u0027ash\u0027 controls login, window manager, ARC++ glue, etc. \u0027lacros\u0027 is the web browser.\n\n\u003e I imagine that telemetry would need to communicate with \u0027ash\u0027 to perform login/logout\nAnd that telemetry would otherwise communicate with \u0027lacros\u0027 as a web browser, as on other OSes.\n\nThat sounds to me like the ash interaction would belong in the platform backend, not the browser backend.",
      "parentUuid": "406d8db6_40b40907",
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f112cd25_3dd18b57",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1451876
      },
      "writtenOn": "2020-11-13T02:00:41Z",
      "side": 1,
      "message": "As it\u0027s currently implemented, we don\u0027t interact with ash beyond what mojo_connection_lacross_launcher.py does.",
      "parentUuid": "f89ff7a1_1de4ccec",
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab4d469e_203d1241",
        "filename": "telemetry/telemetry/internal/backends/chrome/lacros_browser_backend.py",
        "patchSetId": 15
      },
      "lineNbr": 135,
      "author": {
        "id": 1451876
      },
      "writtenOn": "2020-11-12T23:39:08Z",
      "side": 1,
      "message": "The dev tools file existing doesn\u0027t mean the browser is ready. Any ideas about a better condition?",
      "range": {
        "startLine": 135,
        "startChar": 4,
        "endLine": 135,
        "endChar": 17
      },
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f588f307_ea392f84",
        "filename": "telemetry/telemetry/internal/backends/chrome/lacros_browser_backend.py",
        "patchSetId": 15
      },
      "lineNbr": 135,
      "author": {
        "id": 1451876
      },
      "writtenOn": "2020-11-16T23:26:57Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "ab4d469e_203d1241",
      "range": {
        "startLine": 135,
        "startChar": 4,
        "endLine": 135,
        "endChar": 17
      },
      "revId": "68740d33f3f5d0e690752d2dc0cb4793e48237a2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}