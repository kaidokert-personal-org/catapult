{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "607efbd4_7f155e9b",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 777,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-09T18:28:45Z",
      "side": 1,
      "message": "Can you clarify this is \"versionCode\" so it\u0027s not confused with versionName? Also, it looks like this parameter is ignored if \"pm list\" returns the package, but this isn\u0027t clear from the docs.",
      "range": {
        "startLine": 777,
        "startChar": 19,
        "endLine": 777,
        "endChar": 26
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fceb7f1_f1793d62",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 777,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-10-09T18:56:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "607efbd4_7f155e9b",
      "range": {
        "startLine": 777,
        "startChar": 19,
        "endLine": 777,
        "endChar": 26
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12d79d88_8e7c9f89",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 1331,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-09T18:28:45Z",
      "side": 1,
      "message": "If you want to check the install succeeded, how about just checking the versionCode of the package on the device? This would catch failed upgrades too. You would need to implement device_utils.GetApplicationVersionCode() (you should be able to pattern this off GetApplicationVersion)",
      "range": {
        "startLine": 1331,
        "startChar": 4,
        "endLine": 1331,
        "endChar": 66
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6614b43_a67af6ab",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 1331,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-10-09T18:56:46Z",
      "side": 1,
      "message": "IIUC this should already catch failed upgrades if the APK has a version code. I don\u0027t believe just checking the version code is sufficient for all packages, as not all packages appear to report one. See the sample output from \"dumpsys package\" from when I was originally debuggin this: https://chromium-swarm.appspot.com/task?id\u003d4f1419c3f3229f10\n\norg.chromium.trichromelibrary has version\u003d, but none of the other APKs do.",
      "parentUuid": "12d79d88_8e7c9f89",
      "range": {
        "startLine": 1331,
        "startChar": 4,
        "endLine": 1331,
        "endChar": 66
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d1669c5_374f8366",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 1331,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-09T19:25:03Z",
      "side": 1,
      "message": "\u003e IIUC this should already catch failed upgrades if the APK has a version code.\n\nYou mean this is already implemented? Checking the versionCode is stronger than checking if a package is installed, so I don\u0027t think we need to do both (i.e., Android can\u0027t report a package\u0027s versionCode if the package was never installed).\n\n\u003e I don\u0027t believe just checking the version code is sufficient for all packages, as not all packages appear to report one. See the sample output from \"dumpsys package\" from when I was originally debuggin this: https://chromium-swarm.appspot.com/task?id\u003d4f1419c3f3229f10\n\u003e\n\u003e org.chromium.trichromelibrary has version\u003d, but none of the other APKs do.\n\nAll apps should (I think \"must\") have versionCodes (https://developer.android.com/guide/topics/manifest/manifest-element#vcode). This is reported by `adb shell dumpsys package \u003cpackagename\u003e | grep \u0027versionCode\u003d\u0027` for a package already installed on the device. `adb shell dumpsys package` should report it too, but it looks like the output was truncated on that swarming page (that only gets up to \"Permissions:\", which is a few sections before \"Packages:\").\n\nI think only Static Shared Libraries have a \"version\u003d\" in the \"Libraries:\" section because only Static Shared Libraries can have multiple versions installed side-by-side. But I assume this check is meant to handle more than just Static Shared Libraries.",
      "parentUuid": "c6614b43_a67af6ab",
      "range": {
        "startLine": 1331,
        "startChar": 4,
        "endLine": 1331,
        "endChar": 66
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e13ad78b_3570cd8c",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 5
      },
      "lineNbr": 1331,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-09T19:54:46Z",
      "side": 1,
      "message": "\u003e You would need to implement device_utils.GetApplicationVersionCode() (you should be able to pattern this off GetApplicationVersion)\n\nActually, this wouldn\u0027t work for Static Shared Libraries (since they can have multiple versions installed).\n\nI think it would be better to stick with the extra parameter on IsApplicationInstalled(), but just skip to the \"dumpsys package\" case if a versionCode was passed in.",
      "parentUuid": "8d1669c5_374f8366",
      "range": {
        "startLine": 1331,
        "startChar": 4,
        "endLine": 1331,
        "endChar": 66
      },
      "revId": "b2956095b9eaa45eea5dcddd5f14b951fcbe78d0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}