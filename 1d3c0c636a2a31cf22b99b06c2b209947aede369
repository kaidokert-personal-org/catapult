{
  "comments": [
    {
      "key": {
        "uuid": "31de6951_de561d22",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1181690
      },
      "writtenOn": "2018-12-18T17:27:14Z",
      "side": 1,
      "message": "Could we instead just pass large_output\u003dTrue here?",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7154dfb8_f46f6d22",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1153089
      },
      "writtenOn": "2018-12-18T18:48:08Z",
      "side": 1,
      "message": "That would not eliminate the problem as exit code parsing will still be racy, i.e. stderr may come after stdout despite being issued by an earlier command and the following warning will still be printed:\n\nWARNING   exit status of shell command \u0027a\u003d/data/local/tmp/md5sum/md5sum_bin;! [[ $(ls -l $a) \u003d *313200* ]]\u0026\u0026exit 2;export LD_LIBRARY_PATH\u003d/data/local/tmp/md5sum;$a /data/local/tmp/v8/bin/icudtl.dat;:\u0027 missing.",
      "parentUuid": "31de6951_de561d22",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "72ffd6e9_a2761f9c",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2018-12-20T10:20:24Z",
      "side": 1,
      "message": "I think John is right. With large_output\u003dTrue both stdout/stderr of the command is sent to a file on the device [1]; while the exit status is still written to and read from stdout [2]. So, no more race?\n\n[1]: https://cs.chromium.org/chromium/src/third_party/catapult/devil/devil/android/device_utils.py?rcl\u003d7d95d86a652fb83e619f1861708d19f938bf32de\u0026l\u003d1123\n[2]: https://cs.chromium.org/chromium/src/third_party/catapult/devil/devil/android/sdk/adb_wrapper.py?rcl\u003d7d95d86a652fb83e619f1861708d19f938bf32de\u0026l\u003d532",
      "parentUuid": "7154dfb8_f46f6d22",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a609a714_9d787503",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1153089
      },
      "writtenOn": "2018-12-20T12:46:18Z",
      "side": 1,
      "message": "Good point, I forgot that output is written to a file with large_output\u003dTrue. Done.\n\nOne minor concern I have is that it adds some overhead to this low-level command that may be called a lot for tests that have many files accompanying them. If that\u0027s negligible, why aren\u0027t we using large_output\u003dTrue for everything, i.e. make it a default?",
      "parentUuid": "72ffd6e9_a2761f9c",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d9428e01_f6706fef",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1181690
      },
      "writtenOn": "2018-12-20T15:07:23Z",
      "side": 1,
      "message": "It\u0027s not a default because large_output does introduce some overhead. I think it makes sense to use here because we checksum everything on the device for a given call to PushChangedFiles in a single call to this function.",
      "parentUuid": "a609a714_9d787503",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a623469a_b1567334",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1153089
      },
      "writtenOn": "2019-01-11T07:41:05Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "d9428e01_f6706fef",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e7ea8d0c_df4040e9",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 1181690
      },
      "writtenOn": "2018-12-18T17:27:14Z",
      "side": 1,
      "message": "... and here?",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4c187bd9_1ec54cb7",
        "filename": "devil/devil/android/md5sum.py",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 1153089
      },
      "writtenOn": "2018-12-20T12:46:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e7ea8d0c_df4040e9",
      "revId": "1d3c0c636a2a31cf22b99b06c2b209947aede369",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}