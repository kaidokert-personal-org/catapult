{
  "comments": [
    {
      "key": {
        "uuid": "a1916044_38f20a96",
        "filename": "catapult_build/test_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2018-07-24T12:26:16Z",
      "side": 1,
      "message": "is this here just for debugging? don\u0027t forget to remove.",
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80008794_43270a4c",
        "filename": "catapult_build/test_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Whoops. Had that in while trying to grok the control flow inside of Catapult. It\u0027s gone, but I\u0027ll bet there are others I\u0027ve forgotten.",
      "parentUuid": "a1916044_38f20a96",
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "49ad8528_131c26a1",
        "filename": "telemetry/telemetry/internal/backends/chrome/fuchsia_browser_finder.py",
        "patchSetId": 1
      },
      "lineNbr": 31,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "nit: content_shell",
      "range": {
        "startLine": 31,
        "startChar": 38,
        "endLine": 31,
        "endChar": 52
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "08842b7a_72d5f937",
        "filename": "telemetry/telemetry/internal/backends/chrome/fuchsia_browser_finder.py",
        "patchSetId": 1
      },
      "lineNbr": 31,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "49ad8528_131c26a1",
      "range": {
        "startLine": 31,
        "startChar": 38,
        "endLine": 31,
        "endChar": 52
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84dce409_e092a8b6",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "If the device is started, it doesn\u0027t mean that port forwarding is active.",
      "range": {
        "startLine": 38,
        "startChar": 16,
        "endLine": 38,
        "endChar": 34
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14998bdc_b3961188",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 38,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "84dce409_e092a8b6",
      "range": {
        "startLine": 38,
        "startChar": 16,
        "endLine": 38,
        "endChar": 34
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "51e57889_9d038d12",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "This doesn\u0027t look like something that belongs to a \"Forwarder\". Forwarder should be responsible for forwarding network connections, not for running commands on a remote device.",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 17
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f5ef32f9_653672b7",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "51e57889_9d038d12",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 17
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2f175fb3_102d5cb9",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 90,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "I don\u0027t think we want ForwarderFactory should be responsible for setting up a device. I think this belongs to FuchsiaPlatformBackend.\n\nAlso when creating a device I think we want to use the configuration (address and SSH identity) from the FuchsiaDevice object passed to FuchsiaPlatformBackend.__init__().",
      "range": {
        "startLine": 89,
        "startChar": 10,
        "endLine": 90,
        "endChar": 63
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0549cd42_be85394b",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 90,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Yeah, having read Juan\u0027s comments in a similar vein, I\u0027ve gutted the forwarder class, and I\u0027m going to move its functionality into a fuchsia interface that the platform backend instantiates and directly owns.",
      "parentUuid": "2f175fb3_102d5cb9",
      "range": {
        "startLine": 89,
        "startChar": 10,
        "endLine": 90,
        "endChar": 63
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "183de5f7_6c88e3c8",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2018-07-24T14:04:54Z",
      "side": 1,
      "message": "Not sure how things work for fuchsia, but you will probably need the forward and reverse forwarder. The diagram here might help: https://docs.google.com/document/d/1l4CIqZACAlyogsbPESz0IY3FS4bS7f-DimVQC1uM-os/edit#bookmark\u003did.agwxg3885d6x\n\nA \"regular\" forwarder (no. 2 in the diagram) is used to send web page recordings from the host to the Chrome instance on the device; while a \"reverse\" forwarder (no. 6) is used to establish a connection between DevTools agent (on the device) and its DevToolsClient (part of Telemetry) in the host.\n\nAlso I think this is mixing the roles of the \"forwarder\" and the \"platform/device\". Sorry because due to legacy reasons this is slightly messy in the current code base.\n\nThe \"forwarder\" should simply establish a network connection between/host device. And that\u0027s pretty much it. It shouldn\u0027t have, e.g., \"RunCommand\" methods.\n\nThe \"Device\" should just hold information necessary to identify a particular fuchsia device connected to the host (what you have below as FuchsiaDevice is probably right).\n\nThen you do probably want to define a \"FuchsiaInterface\" or something like that, similar to CrOSInterface [1] which is the thing that you use to send and run commands on the device.\n\nFinally the \"platform\" should take an instance of your FuchsiaDevice, create a FuchsiaInterface from it, and keep a reference to it (e.g. as in [2]) so the platform can implement its required interface calling methods of this object (and *not* the forwarder).\n\nNote _forwarder as a member of the platform backend is going away (see crbug.com/799415), so you shouldn\u0027t attempt at changing it\u0027s API or constructor arguments.\n\n[1]: https://cs.chromium.org/chromium/src/third_party/catapult/telemetry/telemetry/core/cros_interface.py?rcl\u003d2a64e6b6d554193f50f82d9557442615457365d9\u0026l\u003d94\n[2]: https://cs.chromium.org/chromium/src/third_party/catapult/telemetry/telemetry/internal/platform/cros_platform_backend.py?rcl\u003d2a64e6b6d554193f50f82d9557442615457365d9\u0026l\u003d22",
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d893a5ba_06e6db02",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2018-07-24T14:07:42Z",
      "side": 1,
      "message": "Looking a bit more into it my proposed \"FuchsiaInterface\" is probably your \"DeviceTarget\" ? Btw, where is that defined?",
      "parentUuid": "183de5f7_6c88e3c8",
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2cc4ba2f_4cf55bfc",
        "filename": "telemetry/telemetry/internal/forwarders/fuchsia_forwarder.py",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "That\u0027s inside /build/fuchsia directly inside the Chromium repository, and requires a bit of path hackery to import it into Catapult. But yeah, DeviceTarget specifically is the thing that manages talking to Fuchsia devices over SSH and booting them and whatnot.",
      "parentUuid": "d893a5ba_06e6db02",
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ef39ba17_ef60ab36",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_device.py",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "This option is set with --identity flag. I think we want to rename it to ssh_identity if we want to use it here.\n\nBut note that SSH config that we use to connect to Fuchsia devices contains a reference to the identity file and some other configuration. It\u0027s better to use it here instead of just ssh_identity - it enables SSH persistent connection, which makes things significantly faster. I suggest updating FuchsiaDevice() to take ssh_config instead of ssh_identity and add a new option to pass ssh_config when starting catapult.",
      "range": {
        "startLine": 43,
        "startChar": 42,
        "endLine": 43,
        "endChar": 59
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e544b46f_424f02c0",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_device.py",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "Maybe add a separate options flag for the device IP? Then this class will return a non-empty list when we have a device.",
      "range": {
        "startLine": 43,
        "startChar": 24,
        "endLine": 43,
        "endChar": 28
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6b8907b6_d32e436f",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_device.py",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "I\u0027ve added an --ssh_config option for catapult",
      "parentUuid": "ef39ba17_ef60ab36",
      "range": {
        "startLine": 43,
        "startChar": 42,
        "endLine": 43,
        "endChar": 59
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "181bde32_149a39fe",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_device.py",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "There actually is a flag already that specifies a remote device\u0027s IP address. I\u0027ve changed the flag\u0027s target from cros_remote to remote, because it isn\u0027t specific to ChromeOS, and it saves us having to add another flag that does the same thing. I believe I\u0027ve found all the instances of cros_remote and refactored them to just remote, but someone more familiar with the codebase might find some corner cases git grep missed.",
      "parentUuid": "e544b46f_424f02c0",
      "range": {
        "startLine": 43,
        "startChar": 24,
        "endLine": 43,
        "endChar": 28
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c68b5078_d60cf5ea",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "Fuchsia",
      "range": {
        "startLine": 77,
        "startChar": 12,
        "endLine": 77,
        "endChar": 18
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb4e6d1e_c4979b06",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c68b5078_d60cf5ea",
      "range": {
        "startLine": 77,
        "startChar": 12,
        "endLine": 77,
        "endChar": 18
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a96e953_6fbddf12",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "Maybe return contents of third_party/fuchsia-sdk/sdk/.hash ?",
      "range": {
        "startLine": 80,
        "startChar": 12,
        "endLine": 80,
        "endChar": 52
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a99e4132_1af0aad7",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7a96e953_6fbddf12",
      "range": {
        "startLine": 80,
        "startChar": 12,
        "endLine": 80,
        "endChar": 52
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4d226add_8249c2a3",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "Is this really used for anything? If not, then maybe keep it non-implemented until we need it.",
      "range": {
        "startLine": 93,
        "startChar": 6,
        "endLine": 93,
        "endChar": 16
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ef90d15a_4a653f1b",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 93,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "It\u0027s hard to tell if the version of it I\u0027ve implemented is actually used anywhere, but I\u0027ve added a \u0027raise NotImplementedError()\u0027 until we know if it is. Before this is submitted, I\u0027ll either remove that if it is used, or delete the implementation fully if it isn\u0027t useful.",
      "parentUuid": "4d226add_8249c2a3",
      "range": {
        "startLine": 93,
        "startChar": 6,
        "endLine": 93,
        "endChar": 16
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300b2bcb_c47cb58a",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2018-07-24T18:58:13Z",
      "side": 1,
      "message": "We don\u0027t need to copy docs from the interface definition to implementation.",
      "range": {
        "startLine": 94,
        "startChar": 0,
        "endLine": 103,
        "endChar": 7
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55f76b62_78c3441f",
        "filename": "telemetry/telemetry/internal/platform/fuchsia_platform_backend.py",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1279964
      },
      "writtenOn": "2018-07-24T23:05:13Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "300b2bcb_c47cb58a",
      "range": {
        "startLine": 94,
        "startChar": 0,
        "endLine": 103,
        "endChar": 7
      },
      "revId": "48773769ea07c18bd9655028bd77ee478f759a12",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}