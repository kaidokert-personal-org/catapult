{
  "comments": [
    {
      "key": {
        "uuid": "3a5ed676_a08f919b",
        "filename": "telemetry/telemetry/internal/platform/tracing_agent/perfetto_tracing_agent.py",
        "patchSetId": 7
      },
      "lineNbr": 44,
      "author": {
        "id": 1322871
      },
      "writtenOn": "2019-12-05T10:59:25Z",
      "side": 1,
      "message": "Remove duration_ms since we\u0027ll use a trigger config instead.\n\ntrigger_config: {\n  trigger_mode: STOP_TRACING\n  triggers: {\n    name: \"stop_chrome_trace_any_string_you_want\"\n    stop_delay_ms: 0\n  }\n  trigger_timeout_ms: \u003cmaximum time you are willing to have a trace go for\u003e\n}\n\nThen add a new \"trace config\" that only has the exact trigger string you defined above. I.E.\n\n_TRIGGER_CONFIG \u003d \"\"\"\nactivate_triggers \u003d \"stop_chrome_trace_any_string_you_want\"\n\"\"\"\n\nThen rather then SIGINT send\n\ncmd \u003d [self.PERFETTO_BIN, \u0027--config\u0027, _TRIGGER_CONFIG]\n\nThough you\u0027ll need to convert _TRIGGER_CONFIG the same way you do _TRACE_CONFIG.",
      "revId": "a113fa237aa39d816356b171d4066defb939d7fb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "29cc26a6_bcdd33f0",
        "filename": "telemetry/telemetry/internal/platform/tracing_agent/perfetto_tracing_agent.py",
        "patchSetId": 7
      },
      "lineNbr": 44,
      "author": {
        "id": 1322871
      },
      "writtenOn": "2019-12-05T11:01:58Z",
      "side": 1,
      "message": "Actually I think they added a helper binary that is simpler to use \n\nhttps://cs.corp.google.com/aosp-android10/external/perfetto/src/perfetto_cmd/trigger_perfetto.cc?g\u003d0\n\nSo you should be able to install the \"trigger_perfetto\" binary and then just do\n\ncmd \u003d [self.TRIGGER_PERFETTO_BIN, \u0027stop_chrome_any_string_you_want\"]",
      "parentUuid": "3a5ed676_a08f919b",
      "revId": "a113fa237aa39d816356b171d4066defb939d7fb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26d0c990_5fb45b67",
        "filename": "telemetry/telemetry/internal/platform/tracing_agent/perfetto_tracing_agent.py",
        "patchSetId": 7
      },
      "lineNbr": 44,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2019-12-05T13:35:30Z",
      "side": 1,
      "message": "Thanks! Done.\n\nAlthough somehow the trace still comes out empty when I load it into Perfetto UI :(\n\nMaybe I\u0027m missing something else?",
      "parentUuid": "29cc26a6_bcdd33f0",
      "revId": "a113fa237aa39d816356b171d4066defb939d7fb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a81a1c69_9f47bf2f",
        "filename": "telemetry/telemetry/internal/platform/tracing_agent/perfetto_tracing_agent.py",
        "patchSetId": 7
      },
      "lineNbr": 75,
      "author": {
        "id": 1322871
      },
      "writtenOn": "2019-12-05T10:59:25Z",
      "side": 1,
      "message": "Is this trying to kill any previous running binaries?\n\nWhat about the system? won\u0027t this not work for anything P+ pixel device and R+ device with it enabled by default?",
      "revId": "a113fa237aa39d816356b171d4066defb939d7fb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb030ef0_f7a3b4ca",
        "filename": "telemetry/telemetry/internal/platform/tracing_agent/perfetto_tracing_agent.py",
        "patchSetId": 7
      },
      "lineNbr": 75,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2019-12-05T13:35:30Z",
      "side": 1,
      "message": "I\u0027ve added a version check to skip this on newer versions. We can also later tweak it as needed.",
      "parentUuid": "a81a1c69_9f47bf2f",
      "revId": "a113fa237aa39d816356b171d4066defb939d7fb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}