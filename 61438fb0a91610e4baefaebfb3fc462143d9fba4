{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "eb7e778f_9ad6f379",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-10-06T22:16:42Z",
      "side": 1,
      "message": "PTAL\n\nAfter looking a bit more closely at the failures that prompted this, I\u0027m not 100% sure it\u0027s an issue of \"we asked this to be installed and it wasn\u0027t\", but this should still confirm whether that\u0027s the case or not. The added logic to look for packages that don\u0027t show up via \"pm list packages\" will be helpful regardless, particularly if more APKs end up having this weird behavior further down the line.",
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae92334d_3d88f765",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1170419
      },
      "writtenOn": "2020-10-08T18:28:34Z",
      "side": 1,
      "message": "Can\u0027t say I\u0027m a fan of hard-coding trichrome here.\n\n+Andrew/Nate: Do we know where this version code is coming from? I\u0027m wondering if we can safely make that suffix optional for _any_ package.",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09aeaca7_6f995453",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-10-08T18:30:28Z",
      "side": 1,
      "message": "AFAIK it should be safe to try both if that\u0027s preferable to keeping a list of known packages.",
      "parentUuid": "ae92334d_3d88f765",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "198e9889_33260a59",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-08T19:20:52Z",
      "side": 1,
      "message": "Static Shared Libraries (the Android platform feature Trichrome uses) report a package name with \"some unique number\" appended to the end, as a way of allowing multiple versions of the same package to be installed simultaneously. As I understand, it\u0027s an implementation detail that \"some unique number\" happens to be the versionCode. torne@ is the expert here, although he\u0027s documented some of this here: http://go/clank-webview-legacy/building-webview/trichrome-local-development (see \"special note about the installed library\").\n\nProbably best not to hardcode the trichrome packages. Each different channel has a different package name, so your list is missing com.google.android.trichromelibrary, com.google.android.trichromelibrary.{debug,canary,dev,beta}, and possibly others.",
      "parentUuid": "09aeaca7_6f995453",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa2134fa_a50c013f",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1109505
      },
      "writtenOn": "2020-10-08T21:55:41Z",
      "side": 1,
      "message": "It\u0027s an implementation detail but I suspect it\u0027s unlikely to change in practise. If you wanted to be very cautious the \"official\" mapping is in the Libraries: list near the beginning of the \"dumpsys package\" output; it maps all the installed libraries on the system and their versions to how they are actually stored.\n\nHowever there\u0027s a more significant issue here which is that the whole point of this is that static shared libraries can have more than one version installed at once, and thus it\u0027s somewhat meaningless to determine \"if they are installed\" without specifying an exact version you are interested in. What is this actually used for? Is it just to verify that installing it succeeded? If so then just ignoring the version will *not* achieve that, because the install could have failed but a different version might already have been installed beforehand. You really need to be considering it as a (packageName, versionCode) tuple.\n\nAnd yes, please don\u0027t hardcode the trichrome library packages if there\u0027s any way to avoid it, because there are a number of different package names as Nate mentions.",
      "parentUuid": "198e9889_33260a59",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f234d425_0417f91f",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1163549
      },
      "writtenOn": "2020-10-08T23:54:54Z",
      "side": 1,
      "message": "\u003e You really need to be considering it as a (packageName, versionCode) tuple\nIs there a way to get the version code from the APK? If not, there\u0027s no way we can determine whether a given APK is already installed on the device.",
      "parentUuid": "fa2134fa_a50c013f",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "94b3cf43_1e15a324",
        "filename": "devil/devil/android/device_utils.py",
        "patchSetId": 3
      },
      "lineNbr": 285,
      "author": {
        "id": 1167294
      },
      "writtenOn": "2020-10-08T23:58:26Z",
      "side": 1,
      "message": "Is apk_helper what you\u0027re looking for? https://source.chromium.org/chromium/chromium/src/+/master:third_party/catapult/devil/devil/android/apk_helper.py;l\u003d314;drc\u003d4ac015d92df8914e07695676f8368dd6f5baf958",
      "parentUuid": "f234d425_0417f91f",
      "range": {
        "startLine": 284,
        "startChar": 31,
        "endLine": 285,
        "endChar": 37
      },
      "revId": "61438fb0a91610e4baefaebfb3fc462143d9fba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}