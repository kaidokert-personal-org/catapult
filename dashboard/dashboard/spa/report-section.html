<!DOCTYPE html>
<!--
Copyright 2018 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="/dashboard/spa/cp-loading.html">
<link rel="import" href="/dashboard/spa/cp-toast.html">
<link rel="import" href="/dashboard/spa/element-base.html">
<link rel="import" href="/dashboard/spa/menu-input.html">
<link rel="import" href="/dashboard/spa/raised-button.html">
<link rel="import" href="/dashboard/spa/report-controls.html">
<link rel="import" href="/dashboard/spa/report-names-request.html">
<link rel="import" href="/dashboard/spa/report-request.html">
<link rel="import" href="/dashboard/spa/report-table.html">
<link rel="import" href="/dashboard/spa/report-template-request.html">
<link rel="import" href="/dashboard/spa/report-template.html">
<link rel="import" href="/dashboard/spa/request-base.html">
<link rel="import" href="/dashboard/spa/scalar-span.html">
<link rel="import" href="/dashboard/spa/team-filter.html">
<link rel="import" href="/dashboard/spa/test-suites-request.html">
<link rel="import" href="/dashboard/spa/utils.html">

<dom-module id="report-section">
  <template>
    <style>
      #tables {
        align-items: center;
        display: flex;
        flex-direction: column;
        margin-top: 16px;
      }

      #scratch {
        opacity: 0;
        position: absolute;
        z-index: var(--layer-hidden);
      }
    </style>

    <report-controls state-path="[[statePath]]">
    </report-controls>

    <cp-loading loading$="[[isLoading]]"></cp-loading>

    <div id="tables">
      <template is="dom-repeat" items="[[tables]]" as="table" index-as="tableIndex">
        <!-- TODO abs-pos the template over the table instead of iron-collapse-->
        <template is="dom-if" if="[[canEdit_(table, userEmail)]]">
          <iron-collapse horizontal opened="[[table.isEditing]]">
            <iron-collapse class="edit_form" opened="[[table.isEditing]]">
              <report-template state-path="[[statePath]].tables.[[tableIndex]]">
              </report-template>
            </iron-collapse>
          </iron-collapse>
        </template>

        <iron-collapse horizontal opened="[[!table.isEditing]]">
          <iron-collapse class="report" opened="[[!table.isEditing]]">
            <report-table state-path="[[statePath]].tables.[[tableIndex]]">
            </report-table>
          </iron-collapse>
        </iron-collapse>
      </template>
    </div>

    <cp-toast id="copied" opened="[[copiedMeasurements]]">
      Copied measurements
    </cp-toast>

    <div id="scratch">
    </div>
  </template>
</dom-module>
<script src="/dashboard/spa/report-section.js"></script>
