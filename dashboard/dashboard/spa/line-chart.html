<!DOCTYPE html>
<!--
Copyright 2017 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<dom-module id="line-chart">
  <template>
    <style>
      .axis {
        stroke-width: 1;
      }

      .tickLine {
        stroke-width: 1;
        stroke: rgba(0, 0, 0, 0.1);
      }

      circle:hover {
        opacity: 1;
      }
    </style>

    <svg id="svg"
         width$="[[layout.width]]"
         height$="[[layout.height]]">
      <!-- TODO are axis lines necessary?
      <line x1$="[[layout.left]]"
            x2$="[[layout.left]]"
            y1$="[[layout.top]]"
            y2$="[[layout.bottom]]"
            class="axis">
      </line>
      <line x1$="[[layout.left]]"
            x2$="[[layout.right]]"
            y1$="[[layout.bottom]]"
            y2$="[[layout.bottom]]"
            class="axis">
      </line>
      -->

      <template is="dom-repeat" items="[[layout.yAxisTicks]]" as="tick">
        <text x$="[[tick.x]]" y$="[[tick.y]]">[[tick.text]]</text>

        <template is="dom-if" if="[[layout.showYAxisTickLines]]">
          <line x1$="[[layout.left]]"
                x2$="[[layout.right]]"
                y1$="[[tick.y]]"
                y2$="[[tick.y]]"
                class="tickLine">
          </line>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.xAxisTicks]]" as="tick">
        <text x$="[[tick.x]]" y$="[[tick.y]]">[[tick.text]]</text>

        <template is="dom-if" if="[[layout.showXAxisTickLines]]">
          <line x1$="[[tick.x]]"
                x2$="[[tick.x]]"
                y1$="[[layout.top]]"
                y2$="[[layout.bottom]]"
                class="tickLine">
          </line>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.sequences]]" as="sequence">
        <path d$="[[sequence.path]]"
              stroke$="[[sequence.color]]"
              fill="none"
              stroke-width="2">
        </path>

        <template is="dom-repeat" items="[[sequence.data]]" as="datum">
          <circle cx$="[[datum.x]]"
                  cy$="[[datum.y]]"
                  r$="[[layout.dotRadius]]"
                  fill$="[[sequence.dotColor]]"
                  opacity="0"
                  on-tap="onDotClick_">
          </circle>

          <template is="dom-repeat" items="[[datum.icons]]" as="icon">
            <!-- TODO -->
          </template>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.antiBrushes]]" as="antiBrush">
        <rect x$="[[antiBrush.x]]"
              y$="[[layout.top]]"
              width$="[[antiBrush.width]]"
              height$="[[layout.bottom]]"
              fill="rgba(0, 0, 0, 0.2)">
        </rect>

        <rect x$="[[antiBrush.x]]"
              y$="[[layout.brushHandleTop]]"
              width="10"
              height="30"
              fill="rgba(0, 0, 0, 0.6)"
              on-mousedown="onBrushHandleMouseDown_"
              on-mousemove="onBrushHandleMouseMove_"
              on-mouseup="onBrushHandleMouseUp_">
        </rect>

        <rect x$="[[antiBrush.right]]"
              y$="[[layout.brushHandleTop]]"
              width="10"
              height="30"
              fill="rgba(0, 0, 0, 0.6)"
              on-mousedown="onBrushHandleMouseDown_"
              on-mousemove="onBrushHandleMouseMove_"
              on-mouseup="onBrushHandleMouseUp_">
        </rect>
      </template>
    </svg>
  </template>
</dom-module>

<script src="/dashboard/spa/line-chart.js"></script>
