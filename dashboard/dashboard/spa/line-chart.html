<!DOCTYPE html>
<!--
Copyright 2017 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<dom-module id="line-chart">
  <template>
    <style>
      .tickLine {
        stroke-width: 1;
        stroke: #ccc;
      }

      circle:hover {
        opacity: 1;
      }
    </style>

    <svg id="svg"
         width$="[[layout.width]]"
         height$="[[layout.height]]">
      <template is="dom-repeat" items="[[layout.yAxisTicks]]" as="tick">
        <text x$="[[tick.x]]" y$="[[tick.y]]" alignment-baseline="middle">[[tick.text]]</text>

        <template is="dom-if" if="[[layout.showYAxisTickLines]]">
          <line x1$="[[layout.left]]"
                x2$="[[layout.right]]"
                y1$="[[tick.y]]"
                y2$="[[tick.y]]"
                class="tickLine">
          </line>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.xAxisTicks]]" as="tick">
        <text x$="[[tick.x]]" y$="[[tick.y]]" text-anchor="middle">[[tick.text]]</text>

        <template is="dom-if" if="[[layout.showXAxisTickLines]]">
          <line x1$="[[tick.x]]"
                x2$="[[tick.x]]"
                y1$="[[layout.top]]"
                y2$="[[layout.bottom]]"
                class="tickLine">
          </line>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.sequences]]" as="sequence">
        <path d$="[[sequence.path]]"
              stroke$="[[sequence.color]]"
              fill="none"
              stroke-width="2">
        </path>

        <template is="dom-repeat" items="[[sequence.data]]" as="datum">
          <circle cx$="[[datum.x]]"
                  cy$="[[datum.y]]"
                  r$="[[layout.dotRadius]]"
                  fill$="[[sequence.dotColor]]"
                  opacity="0"
                  on-tap="onDotClick_">
          </circle>

          <template is="dom-repeat" items="[[datum.icons]]" as="icon">
            <!-- TODO -->
          </template>
        </template>
      </template>

      <template is="dom-repeat" items="[[layout.antiBrushes]]" as="antiBrush">
        <rect x$="[[antiBrush.x]]"
              y$="[[layout.top]]"
              width$="[[antiBrush.width]]"
              height$="[[layout.bottom]]"
              fill="rgba(0, 0, 0, 0.2)">
        </rect>

        <template is="dom-if" if="[[antiBrush.leftHandle]]">
          <rect x$="[[antiBrush.leftHandleX]]"
                y$="[[layout.brushHandleTop]]"
                width="10"
                height="20"
                fill="rgba(0, 0, 0, 0.4)"
                cursor="move"
                on-mousedown="onBrushHandleMouseDown_"
                on-mousemove="onBrushHandleMouseMove_"
                on-mouseup="onBrushHandleMouseUp_">
          </rect>
        </template>

        <template is="dom-if" if="[[antiBrush.rightHandle]]">
          <rect x$="[[antiBrush.rightHandleX]]"
                y$="[[layout.brushHandleTop]]"
                width="10"
                height="20"
                fill="rgba(0, 0, 0, 0.4)"
                cursor="move"
                on-mousedown="onBrushHandleMouseDown_"
                on-mousemove="onBrushHandleMouseMove_"
                on-mouseup="onBrushHandleMouseUp_">
          </rect>
        </template>
      </template>
    </svg>
  </template>
</dom-module>

<script src="/dashboard/spa/line-chart.js"></script>
