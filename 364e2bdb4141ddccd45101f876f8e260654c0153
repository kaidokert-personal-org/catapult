{
  "comments": [
    {
      "key": {
        "uuid": "a2c06166_8a5f1721",
        "filename": "telemetry/telemetry/internal/story_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2019-06-19T11:08:14Z",
      "side": 1,
      "message": "maybe swapping here the order of the `with` and the `try` should do the work?",
      "revId": "364e2bdb4141ddccd45101f876f8e260654c0153",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "659ea06b_c5501d1d",
        "filename": "telemetry/telemetry/internal/story_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 1328067
      },
      "writtenOn": "2019-06-20T15:47:00Z",
      "side": 1,
      "message": "I\u0027m not 100% sure, but we may lose all the logs from exception processing in that case (e.g. from all the calls to ProcessError down here).",
      "parentUuid": "a2c06166_8a5f1721",
      "revId": "364e2bdb4141ddccd45101f876f8e260654c0153",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3638f4dc_3ee87c84",
        "filename": "telemetry/telemetry/internal/story_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 319,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2019-06-19T11:08:14Z",
      "side": 1,
      "message": "see my comment above, ideally \"_RunStoryAndProcessErrorIfNeeded\" should have \"processed\" and recorded this error.\n\n(Aside, this whole code is a big mess, we\u0027ve had crbug.com/866458 open for a long time to try and simplify this. But also is tricky making changes here that don\u0027t have unintended consequences, so we have to do this with care. :-/)",
      "revId": "364e2bdb4141ddccd45101f876f8e260654c0153",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3d788b65_989ade5d",
        "filename": "telemetry/telemetry/internal/story_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 319,
      "author": {
        "id": 1328067
      },
      "writtenOn": "2019-06-19T11:53:16Z",
      "side": 1,
      "message": "In our particular case, swapping `with` and `try` would be sufficient. But the next time we may hit another issue. Having a broad except block that does not even log anything is pretty dangerous, in my opinion.\n\nTotally agree about the general messiness of this code. I might try to look into ways to simplify it a little (but definitely not in this CL).",
      "parentUuid": "3638f4dc_3ee87c84",
      "revId": "364e2bdb4141ddccd45101f876f8e260654c0153",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59a897a7_1b539f8e",
        "filename": "telemetry/telemetry/internal/story_runner.py",
        "patchSetId": 1
      },
      "lineNbr": 319,
      "author": {
        "id": 1123010
      },
      "writtenOn": "2019-06-19T12:10:43Z",
      "side": 1,
      "message": "I also agree, \"a broad except block that does not even log anything\" is a bad bad thing. But fixing that may be part of that later carefully written CL and not this one.\n\nThe issue with your current solution (I think) is that \"handleable\" exceptions (e.g. those processed above in line 154) will be logged and recorded twice. And our logs are pretty spammy already, so I would prefer to avoid that.\n\nMaybe the solution is that _RunStoryAndProcessErrorIfNeeded should not re-raise errors that were already \"processed\". But again, not sure if that can be done as a simple fix here, or should be part of a follow up CL.",
      "parentUuid": "3d788b65_989ade5d",
      "revId": "364e2bdb4141ddccd45101f876f8e260654c0153",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}