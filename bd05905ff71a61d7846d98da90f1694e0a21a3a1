{
  "comments": [
    {
      "key": {
        "uuid": "80dc56fd_7e40809a",
        "filename": "dashboard/dashboard/add_histograms_queue.py",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1327821
      },
      "writtenOn": "2020-02-27T02:57:46Z",
      "side": 1,
      "message": "Why not import the sheriff_config_client and call the appropriate function there instead, so it\u0027s easier to track which module a function is being called from?\n\nfrom dashboard import sheriff_config_client\n# ... then somewhere you need something in that module ...\nx \u003d sheriff_config_client.GetClient()",
      "range": {
        "startLine": 29,
        "startChar": 0,
        "endLine": 29,
        "endChar": 66
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f887acaa_7bea27ac",
        "filename": "dashboard/dashboard/add_point_queue.py",
        "patchSetId": 2
      },
      "lineNbr": 26,
      "author": {
        "id": 1327821
      },
      "writtenOn": "2020-02-27T02:57:46Z",
      "side": 1,
      "message": "same here.",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 66
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "99adb2e0_d82a0831",
        "filename": "dashboard/dashboard/sheriff_config_client.py",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2020-02-27T02:54:34Z",
      "side": 1,
      "message": "Give this method a docstring, e.g.\n\n   \"\"\"Get a singleton SheriffConfigClient instance.\n\n   Most code should use this rather than constructing a SheriffConfigClient directly.\n   \"\"\"",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 19,
        "endChar": 29
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23323430_ba7fd3f0",
        "filename": "dashboard/dashboard/sheriff_config_client.py",
        "patchSetId": 2
      },
      "lineNbr": 20,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2020-02-27T02:54:34Z",
      "side": 1,
      "message": "Call this attribute _client, so that it is private.",
      "range": {
        "startLine": 20,
        "startChar": 42,
        "endLine": 20,
        "endChar": 48
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8dc3772_5ced8f99",
        "filename": "dashboard/dashboard/sheriff_config_client.py",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1327821
      },
      "writtenOn": "2020-02-27T02:57:46Z",
      "side": 1,
      "message": "Why do this instead of a global?\n\n```\n_CACHED_CONFIG_CLIENT \u003d None\n\n\ndef GetClient():\n  if _CACHED_CONFIG_CLIENT is None:\n    _CACHED_CONFIG_CLIENT \u003d SheriffConfigClient()\n  return _CACHED_CONFIG_CLIENT\n```\n\nThe other question is what happens when the stored `_session` in the client is no longer valid? i.e. do we need to change it in cases where the request fails because the auth expired?",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 22,
        "endChar": 38
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "deebfef6_bf945868",
        "filename": "dashboard/dashboard/sheriff_config_client.py",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2020-02-27T03:14:40Z",
      "side": 1,
      "message": "\u003e Why do this instead of a global?\n\nI don\u0027t have a strong opinion either way here, I just want to share some trivia.\n\nThe glib answer is: because your implementation has a bug (missing a \u0027global\u0027 statement\u0027) :P\n\nArguably, there\u0027s less namespace pollution this way.\n\nAlso, this is slightly closer to how a generic @once decorator tends to be implemented.\n\nThe usual implementation is something like:\n\ndef once(f):\n  @functools.wraps(f)\n  def wrapper():\n    result \u003d getattr(f, \u0027_cached_result\u0027, None)\n    if result is None:\n      result \u003d f()\n      f._cached_result \u003d result\n    return result\n  return wrapper\n\nwhich has the slight advantage of not relying on any module globals, which means it will continue to work as expected even during interpreter shutdown (which has a weird phase where module globals are all set to None to try help garbage collection, and ends up causing lots of unexpected None values in threads and __del__ methods).",
      "parentUuid": "a8dc3772_5ced8f99",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 22,
        "endChar": 38
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed67bb53_cb905c82",
        "filename": "dashboard/dashboard/sheriff_config_client.py",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1284623
      },
      "writtenOn": "2020-02-27T02:54:34Z",
      "side": 1,
      "message": "Perhaps rename this to _SheriffConfigClient, so that it is private to this module?",
      "range": {
        "startLine": 25,
        "startChar": 6,
        "endLine": 25,
        "endChar": 25
      },
      "revId": "bd05905ff71a61d7846d98da90f1694e0a21a3a1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}