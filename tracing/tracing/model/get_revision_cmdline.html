<!DOCTYPE html>
<!--
Copyright 2016 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->
<link rel="import" href="/tracing/base/xhr.html">
<link rel="import" href="/tracing/extras/full_config.html">
<link rel="import" href="/tracing/importer/import.html">
<link rel="import" href="/tracing/metrics/all_metrics.html">
<link rel="import" href="/tracing/metrics/metric_map_function.html">
<link rel="import" href="/tracing/model/model.html">
<link rel="import" href="/tracing/mre/mre_result.html">
<link rel="import" href="/tracing/ui/base/dom_helpers.html">
<link rel="import" href="/tracing/ui/base/file.html">
<link rel="import" href="/tracing/ui/base/ui.html">


<script>
'use strict';
/* eslint-disable no-console */

function getRevision(traceFile) {
  const data = tr.b.getSync('' + traceFile);
  const model = new tr.Model();
  const importOptions = new tr.importer.ImportOptions();
  importOptions.pruneEmptyContainers = false;
  importOptions.showImportWarnings = false;

  const impoter = new tr.importer.Import(model, importOptions);
  try {
    impoter.importTraces([data]);
  } catch (e) {
    throw new Error('While loading ' + traceFile + ' got: ' + e.toString());
  }
  for (let i = 0; i < model.metadata.length; i++) {
    if ('revision' in model.metadata[i].value) {
      console.log(JSON.stringify(model.metadata[i].value.revision));
      break;
    }
  }
}

getRevision(sys.argv.slice(1));

</script>
