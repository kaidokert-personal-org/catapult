<!DOCTYPE html>
<!--
Copyright (c) 2018 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="/tracing/core/test_utils.html">
<link rel="import" href="/tracing/extras/importer/linux_perf/ftrace_importer.html">

<script>
'use strict';

tr.b.unittest.testSuite(function() {
  test('fenceEventImport', function() {
    const lines = [
      'HwBinder:581_1-646   (     0) [003] ....  1015.969628: ' +
        'fence_init: driver=sde_fence:crtc111:22307 ' +
        'timeline=crtc111 context=3 seqno=22307',
      'SurfaceFlinger-225   (     0) [000] ....  1015.947755: ' +
        'fence_destroy: driver=kgsl-timeline ' +
        'timeline=kgsl-3d0_8-el.wallpapers18(1605 context=23 seqno=28749',
      'TimedEventQueue-2700 (     0) [000] d..1  1016.657863: ' +
        'fence_enable_signal: driver=sde_fence:crtc111:22321 ' +
         'timeline=crtc111 context=3 seqno=22321',
      'crtc_event:111-251   (     0) [001] d..1  1016.663616: ' +
        'fence_signaled: driver=sde_fence:crtc111:22321 ' +
        'timeline=crtc111 context=3 seqno=22321'
    ];

    const m = tr.c.TestUtils.newModelWithEvents([lines.join('\n')], {
      shiftWorldToZero: false
    });
    assert.isFalse(m.hasImportWarnings);
  });
});
</script>

